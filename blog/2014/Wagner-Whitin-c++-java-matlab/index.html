<!DOCTYPE html> <html lang=""> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> C++, Java and Matlab codes for Wagner-Whitin algorithm | Dr. Chen </title> <meta name="author" content="Zhen Chen"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="python, stochastic inventory, optimization, statistics"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/me.jpg?5892ceb48c5a26cfaaaa07a40acbd654"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://robinchen121.github.io/blog/2014/Wagner-Whitin-c++-java-matlab/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Dr. Chen </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Research </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/teach/">Teach </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/journey/">Academic journey</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> <li class="nav-item active"> <a class="nav-link" href="/zh/blog/2014/Wagner-Whitin-c++-java-matlab/"> ZH</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">C++, Java and Matlab codes for Wagner-Whitin algorithm</h1> <p class="post-meta"> November 02, 2014 </p> <p class="post-tags"> <a href="/blog/2014"> <i class="fa-solid fa-calendar fa-sm"></i> 2014 </a>   ·   <a href="/blog/tag/c"> <i class="fa-solid fa-hashtag fa-sm"></i> c++</a>   <a href="/blog/tag/java"> <i class="fa-solid fa-hashtag fa-sm"></i> java</a>   <a href="/blog/tag/lot-sizing"> <i class="fa-solid fa-hashtag fa-sm"></i> lot sizing</a>   <a href="/blog/tag/wagner-whitin"> <i class="fa-solid fa-hashtag fa-sm"></i> Wagner-Whitin</a>   <a href="/blog/tag/matlab"> <i class="fa-solid fa-hashtag fa-sm"></i> matlab</a>     ·   <a href="/blog/category/c"> <i class="fa-solid fa-tag fa-sm"></i> c++</a>   <a href="/blog/category/java"> <i class="fa-solid fa-tag fa-sm"></i> java</a>   <a href="/blog/category/inventory"> <i class="fa-solid fa-tag fa-sm"></i> inventory</a>   <a href="/blog/category/matlab"> <i class="fa-solid fa-tag fa-sm"></i> matlab</a>   </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h3"><a href="#c-codes">C++ codes</a></li> <li class="toc-entry toc-h3"><a href="#java-codes">Java codes</a></li> <li class="toc-entry toc-h3"><a href="#matlab-codes">matlab codes</a></li> </ul> </div> <hr> <div id="markdown-content" style="text-align: justify"> <p>The Wagner-Whitin algorithm was proposed in Management Science (Wagner and Whitin, 1958) to address the Uncapacitated Lot Sizing Problem (ULSP) in multi-stage batch production without capacity constraints.</p> <p>The algorithm employs the principles of dynamic programming, and its computational complexity is:</p> \[O(N^2),\] <p>where \(N\) is the length of the planning horizon. This algorithm is a polynomial time algorithm. The paper proves two properties satisfied by the optimal solution:</p> <p>(1) Replenishment is optimal only when initial inventory is zero, i.e., zero inventory ordering policy (Known as the ZIO property), which leads to the development of the dynamic algorithm.</p> <p>(2) For any period, assuming ordering is done \(m\) periods in advance, there exists an upper bound on \(m\). In other words, in the optimal strategy, replenishment should not occur excessively early.</p> <h3 id="c-codes">C++ codes</h3> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span><span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span><span class="cpf">&lt;fstream&gt;</span><span class="cp">
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">T</span><span class="o">=</span><span class="mi">12</span><span class="p">;</span>  <span class="c1">// the length of the planning horizon</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">D</span><span class="p">[</span><span class="n">T</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">10</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">154</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">238</span><span class="p">,</span><span class="mi">41</span><span class="p">};</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">s</span><span class="p">[</span><span class="n">T</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">54</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">54</span><span class="p">};</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">h</span><span class="p">[</span><span class="n">T</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">};</span>

<span class="kt">double</span> <span class="nf">min</span><span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="p">,</span><span class="kt">int</span><span class="p">);</span> <span class="c1">// return to the minimum in an array</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="p">,</span><span class="kt">int</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">double</span> <span class="n">cost</span><span class="p">[</span><span class="n">T</span><span class="p">][</span><span class="n">T</span><span class="p">];</span> <span class="c1">// the total cost in a production cycle from one period to another period</span>
	<span class="kt">double</span> <span class="n">Opt_cost</span><span class="p">[</span><span class="n">T</span><span class="p">];</span>  <span class="c1">//optimal total cost from one period to final period T</span>
	<span class="kt">int</span> <span class="n">Order</span><span class="p">[</span><span class="n">T</span><span class="p">];</span>  <span class="c1">// optimal production plan, binary variables denoting whether to product in each period</span>
	<span class="kt">double</span> <span class="n">I</span><span class="p">[</span><span class="n">T</span><span class="p">];</span>  <span class="c1">// inventory on hand in each period</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">T</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">T</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
			<span class="n">cost</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">INT_MAX</span><span class="p">;</span>  <span class="c1">// initializing costs</span>


	<span class="c1">// compute costs for difference production cycles and optimal total cost</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">T</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="kt">double</span> <span class="n">p</span><span class="p">[</span><span class="n">T</span><span class="p">];</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">T</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
				<span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">cost</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
			<span class="n">Opt_cost</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">T</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="kt">double</span> <span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
				<span class="n">sum</span><span class="o">+=</span><span class="n">D</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
			<span class="kt">double</span> <span class="n">h_sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">h_sum</span><span class="o">=</span><span class="n">h_sum</span><span class="o">+</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">sum</span><span class="o">-</span><span class="n">D</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
				<span class="n">sum</span><span class="o">=</span><span class="n">sum</span><span class="o">-</span><span class="n">D</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
				<span class="n">cost</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">Opt_cost</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">h_sum</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="k">else</span>
				<span class="n">cost</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">h_sum</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="kt">double</span> <span class="n">p</span><span class="p">[</span><span class="n">T</span><span class="p">];</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">T</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
			<span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">cost</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
	<span class="n">Opt_cost</span><span class="p">[</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>

	<span class="c1">// backorder to get optimal production plan</span>
	<span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">Opt_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">cost</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
		<span class="p">{</span>
			<span class="n">Order</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">else</span>
		<span class="p">{</span>
			<span class="n">Order</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">Opt_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">cost</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
				<span class="p">{</span>
					<span class="n">index</span><span class="o">=</span><span class="n">k</span><span class="p">;</span>
					<span class="n">Order</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="n">Order</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
				<span class="n">Order</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="n">i</span><span class="o">=</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="c1">// get inventory on hand by the optimal production plan</span>
	<span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">index</span><span class="o">&lt;</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">T</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">Order</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">index</span><span class="o">=</span><span class="n">j</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">==</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="n">Order</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">index</span><span class="o">=</span><span class="n">T</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="kt">double</span> <span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">index</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
			<span class="n">sum</span><span class="o">+=</span><span class="n">D</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">index</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">sum</span><span class="o">=</span><span class="n">sum</span><span class="o">-</span><span class="n">D</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
			<span class="n">I</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">sum</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">i</span><span class="o">=</span><span class="n">index</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"optimal productoin plan:"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
	<span class="n">print</span><span class="p">(</span><span class="n">Order</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
	<span class="c1">//print(cost,T);</span>
	<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"opimtal total cost from each period"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
	<span class="n">print</span><span class="p">(</span><span class="n">Opt_cost</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
	<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"inventory for each period in the optimal production plan"</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
	<span class="n">print</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>

<span class="p">}</span>

<span class="kt">double</span> <span class="nf">min</span><span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">double</span> <span class="n">temp</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="n">temp</span><span class="p">)</span>
			<span class="n">temp</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
	<span class="k">return</span> <span class="n">temp</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>

	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">" "</span><span class="p">;</span>
	<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="java-codes">Java codes</h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SingleItemLS</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="c1">// TODO Auto-generated method stub</span>
		<span class="kt">int</span> <span class="no">T</span> <span class="o">=</span> <span class="mi">12</span><span class="o">;</span> <span class="c1">// length of the planning horizon</span>
		<span class="kt">double</span><span class="o">[]</span> <span class="no">D</span> <span class="o">=</span> <span class="o">{</span><span class="mi">10</span><span class="o">,</span><span class="mi">62</span><span class="o">,</span><span class="mi">12</span><span class="o">,</span><span class="mi">130</span><span class="o">,</span><span class="mi">154</span><span class="o">,</span><span class="mi">129</span><span class="o">,</span><span class="mi">88</span><span class="o">,</span><span class="mi">52</span><span class="o">,</span><span class="mi">124</span><span class="o">,</span><span class="mi">160</span><span class="o">,</span><span class="mi">238</span><span class="o">,</span><span class="mi">41</span><span class="o">};</span>
		<span class="kt">double</span><span class="o">[]</span> <span class="n">s</span> <span class="o">=</span> <span class="o">{</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">,</span><span class="mi">54</span><span class="o">};</span>
		<span class="kt">double</span><span class="o">[]</span> <span class="n">h</span> <span class="o">=</span> <span class="o">{</span><span class="mf">0.4</span><span class="o">,</span><span class="mf">0.4</span><span class="o">,</span><span class="mf">0.4</span><span class="o">,</span><span class="mf">0.4</span><span class="o">,</span><span class="mf">0.4</span><span class="o">,</span><span class="mf">0.4</span><span class="o">,</span><span class="mf">0.4</span><span class="o">,</span><span class="mf">0.4</span><span class="o">,</span><span class="mf">0.4</span><span class="o">,</span><span class="mf">0.4</span><span class="o">,</span><span class="mf">0.4</span><span class="o">,</span><span class="mf">0.4</span><span class="o">};</span>

		<span class="kt">double</span><span class="o">[][]</span> <span class="n">cost</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[</span><span class="no">T</span><span class="o">][</span><span class="no">T</span><span class="o">];</span> <span class="c1">//the total cost in a production cycle from one period to another period</span>
		<span class="kt">double</span><span class="o">[]</span> <span class="nc">OptCost</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[</span><span class="no">T</span><span class="o">];</span> <span class="c1">//optimal total cost from one period to final period T</span>
		<span class="kt">int</span><span class="o">[]</span> <span class="nc">Order</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="no">T</span><span class="o">];</span>  <span class="c1">// optimal production plan, binary variables denoting whether to product in each period</span>
		<span class="kt">double</span><span class="o">[]</span> <span class="no">I</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[</span><span class="no">T</span><span class="o">];</span> <span class="c1">// inventory on hand at each period</span>

		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="no">T</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
			<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="no">T</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span>
				<span class="n">cost</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="nc">Double</span><span class="o">.</span><span class="na">MAX_VALUE</span><span class="o">;</span>  <span class="c1">// initialize costs</span>


		<span class="c1">// compute costs for difference production cycles and optimal total cost</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="no">T</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
		<span class="o">{</span>
			<span class="k">if</span><span class="o">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
			<span class="o">{</span>
				<span class="kt">double</span><span class="o">[]</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[</span><span class="no">T</span><span class="o">];</span>
				<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">j</span><span class="o">&lt;</span><span class="no">T</span><span class="o">;</span><span class="n">j</span><span class="o">++)</span>
					<span class="n">p</span><span class="o">[</span><span class="n">j</span><span class="o">]=</span><span class="n">cost</span><span class="o">[</span><span class="n">j</span><span class="o">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">];</span>
				<span class="nc">OptCost</span><span class="o">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">]=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">p</span><span class="o">).</span><span class="na">min</span><span class="o">().</span><span class="na">getAsDouble</span><span class="o">();</span>
			<span class="o">}</span>

			<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="no">T</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span>
			<span class="o">{</span>
				<span class="kt">double</span> <span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
				<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span> <span class="n">k</span><span class="o">++)</span>
					<span class="n">sum</span> <span class="o">+=</span> <span class="no">D</span><span class="o">[</span><span class="n">k</span><span class="o">];</span>
				<span class="kt">double</span> <span class="n">hSum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
				<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span> <span class="n">k</span><span class="o">++)</span>
				<span class="o">{</span>
					<span class="n">hSum</span> <span class="o">=</span> <span class="n">hSum</span> <span class="o">+</span> <span class="n">h</span><span class="o">[</span><span class="n">i</span><span class="o">]*(</span><span class="n">sum</span> <span class="o">-</span> <span class="no">D</span><span class="o">[</span><span class="n">k</span><span class="o">]);</span>
					<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">-</span> <span class="no">D</span><span class="o">[</span><span class="n">k</span><span class="o">];</span>
				<span class="o">}</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">)</span>
					<span class="n">cost</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="nc">OptCost</span><span class="o">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="n">hSum</span> <span class="o">+</span> <span class="n">s</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
				<span class="k">else</span>
					<span class="n">cost</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">hSum</span> <span class="o">+</span> <span class="n">s</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="kt">double</span><span class="o">[]</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">double</span><span class="o">[</span><span class="no">T</span><span class="o">];</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="no">T</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span>
				<span class="n">p</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">cost</span><span class="o">[</span><span class="n">j</span><span class="o">][</span><span class="no">T</span><span class="o">-</span><span class="mi">1</span><span class="o">];</span>
		<span class="nc">OptCost</span><span class="o">[</span><span class="no">T</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">p</span><span class="o">).</span><span class="na">min</span><span class="o">().</span><span class="na">getAsDouble</span><span class="o">();</span>

		<span class="c1">// backward to get optimal production plan</span>
		<span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="no">T</span><span class="o">-</span><span class="mi">1</span><span class="o">;</span>
		<span class="k">while</span> <span class="o">(</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="k">if</span> <span class="o">(</span><span class="nc">OptCost</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">==</span> <span class="n">cost</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">i</span><span class="o">])</span>
			<span class="o">{</span>
				<span class="nc">Order</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
				<span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">;</span>
			<span class="o">}</span>
			<span class="k">else</span>
			<span class="o">{</span>
				<span class="nc">Order</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
				<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
				<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">i</span><span class="o">;</span> <span class="n">k</span><span class="o">++)</span>
				<span class="o">{</span>
					<span class="k">if</span> <span class="o">(</span><span class="nc">OptCost</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">==</span> <span class="n">cost</span><span class="o">[</span><span class="n">k</span><span class="o">][</span><span class="n">i</span><span class="o">])</span>
					<span class="o">{</span>
						<span class="n">index</span> <span class="o">=</span> <span class="n">k</span><span class="o">;</span>
						<span class="nc">Order</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
						<span class="k">break</span><span class="o">;</span>
					<span class="o">}</span>
				<span class="o">}</span>
				<span class="nc">Order</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
				<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">i</span><span class="o">;</span> <span class="n">k</span><span class="o">++)</span>
					<span class="nc">Order</span><span class="o">[</span><span class="n">k</span><span class="o">]</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
				<span class="n">i</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
			<span class="o">}</span>
		<span class="o">}</span>

		<span class="c1">// get optimal inventory at each period by optimal production plan</span>
		<span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
		<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
		<span class="k">while</span> <span class="o">(</span><span class="n">index</span> <span class="o">&lt;</span> <span class="no">T</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="no">T</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span>
			<span class="o">{</span>
				<span class="k">if</span> <span class="o">(</span><span class="nc">Order</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span>
				<span class="o">{</span>
					<span class="n">index</span> <span class="o">=</span> <span class="n">j</span><span class="o">;</span>
					<span class="k">break</span><span class="o">;</span>
				<span class="o">}</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">j</span> <span class="o">==</span> <span class="no">T</span><span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nc">Order</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
				<span class="o">{</span>
					<span class="n">index</span> <span class="o">=</span> <span class="no">T</span><span class="o">;</span>
				<span class="o">}</span>
			<span class="o">}</span>
			<span class="kt">double</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
			<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">index</span><span class="o">;</span> <span class="n">k</span><span class="o">++)</span>
				<span class="n">sum</span> <span class="o">+=</span> <span class="no">D</span><span class="o">[</span><span class="n">k</span><span class="o">];</span>
			<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">index</span><span class="o">;</span> <span class="n">k</span><span class="o">++)</span>
			<span class="o">{</span>
				<span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">-</span> <span class="no">D</span><span class="o">[</span><span class="n">k</span><span class="o">];</span>
				<span class="no">I</span><span class="o">[</span><span class="n">k</span><span class="o">]</span> <span class="o">=</span> <span class="n">sum</span><span class="o">;</span>
			<span class="o">}</span>
			<span class="n">i</span> <span class="o">=</span> <span class="n">index</span><span class="o">;</span>
		<span class="o">}</span>

		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"optimal production plan:"</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="nc">Order</span><span class="o">));</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"optimal total cost from each period:"</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="nc">OptCost</span><span class="o">));</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"optimal inventory at each period:"</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="no">I</span><span class="o">));</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h3 id="matlab-codes">matlab codes</h3> <div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">MyWW</span>
<span class="c1">% x are binary variabes denoting whether to produce in each period</span>
<span class="c1">% y are the production quantities in each period</span>
<span class="c1">% I are the inventory in each period</span>
<span class="c1">% I0 is the initial inventory</span>

<span class="n">I0</span><span class="o">=</span><span class="mi">50</span><span class="p">;</span>
<span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span>

<span class="c1">% d=randi([5 25],1,n);</span>
<span class="c1">% S=randi([20 100],1,n);</span>
<span class="c1">% h=randi([5 20],1,n);</span>
<span class="c1">% c=randi([10 25],1,n);</span>

<span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">];</span>
<span class="n">S</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">];</span>
<span class="n">h</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">];</span>
<span class="n">c</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>

<span class="n">x</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>
<span class="n">y</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>
<span class="n">I</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>

<span class="n">C</span><span class="o">=</span><span class="mf">1e4</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">);</span> <span class="c1">%成本矩阵</span>
<span class="n">opt_cost</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">initial_I</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span>
        <span class="n">opt_cost</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">C</span><span class="p">(:,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
    <span class="k">end</span>
    <span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">:</span><span class="n">n</span>
        <span class="k">if</span> <span class="n">I0</span><span class="o">&gt;=</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">1</span>
                <span class="n">C</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="n">h</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">I0</span><span class="o">-</span><span class="nb">cumsum</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">)))</span><span class="o">'</span><span class="p">;</span>
            <span class="k">else</span>
                <span class="n">C</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="n">opt_cost</span><span class="o">+</span><span class="n">h</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">I0</span><span class="o">-</span><span class="nb">cumsum</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">)))</span><span class="o">'</span><span class="p">;</span>
            <span class="k">end</span>
        <span class="k">else</span>
            <span class="n">initial_I</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">I0</span><span class="p">;</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">I0</span><span class="o">&gt;</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">initial_I</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">I0</span><span class="o">-</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
                <span class="k">else</span>
                    <span class="n">initial_I</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                <span class="k">end</span>
            <span class="k">end</span>
            <span class="n">prod_amount</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">initial_I</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">temp_I</span><span class="o">=</span><span class="n">initial_I</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">prod_amount</span><span class="p">;</span>
            <span class="n">h_sum</span><span class="o">=</span><span class="n">h</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">temp_I</span><span class="o">-</span><span class="nb">cumsum</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">)))</span><span class="o">'</span><span class="p">;</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span>
                <span class="n">C</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="n">opt_cost</span><span class="o">+</span><span class="n">S</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">h_sum</span><span class="o">+</span><span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">prod_amount</span><span class="p">;</span>
            <span class="k">else</span>
                <span class="n">C</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="n">S</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">h_sum</span><span class="o">+</span><span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">prod_amount</span><span class="p">;</span>
            <span class="k">end</span>
        <span class="k">end</span>
   <span class="k">end</span>
<span class="k">end</span>

<span class="c1">%back track</span>
<span class="n">j</span><span class="o">=</span><span class="n">n</span><span class="p">;</span>
<span class="k">while</span> <span class="n">j</span><span class="o">&gt;=</span><span class="mi">1</span>
    <span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">C</span><span class="p">(:,</span><span class="n">j</span><span class="p">));</span>
    <span class="k">if</span> <span class="n">I0</span><span class="o">&lt;</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">index</span><span class="p">))</span>
        <span class="n">x</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span>
            <span class="n">y</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">index</span><span class="p">:</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">initial_I</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
        <span class="k">else</span>
            <span class="n">y</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">index</span><span class="p">:</span><span class="n">j</span><span class="p">))</span><span class="o">-</span><span class="n">initial_I</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">j</span><span class="o">=</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="k">end</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">1</span>
        <span class="n">I</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">I0</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="n">I</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">I</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="k">end</span>
    <span class="nb">fprintf</span><span class="p">(</span><span class="s1">'  %d'</span><span class="p">,</span><span class="n">I</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
<span class="k">end</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s1">'\n'</span><span class="p">);</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s1">'production quantity at each period:\n'</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span>
    <span class="nb">fprintf</span><span class="p">(</span><span class="s1">'  %d'</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
<span class="k">end</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s1">'\n'</span><span class="p">);</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s1">'whether to produce in each period:\n'</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span>
    <span class="nb">fprintf</span><span class="p">(</span><span class="s1">'  %d'</span><span class="p">,</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
<span class="k">end</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s1">'\n'</span><span class="p">);</span>
<span class="k">end</span>
</code></pre></div></div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2016/matlab-c++-codes-for-knapsack-problems/">Matlab and C++ codes for dynamic programming to solve the knapsack problem</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/pursuing-paper-cash-flow-based-dynamic-inventory-management/">Pursuing the paper " cash-flow based dynamic inventory management"</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2016/Matlab-codes-for-genetic-algorithm-to-solve-TSP/">Genetic algorithm in matlab to solve travelling salesman problem</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/pursuing-paper-capacitated-inventory-problems-with-fixed-order-costs/">Pursuing the paper " Capacitated inventory problems with fixed order costs-some optimal policy structure"</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/capacitated-lot-sizing-infinite/">Digging into the paper "the infinite horizon periodic review problem with setup costs"</a> </li> <div id="giscus_thread" style="max-width: 1000px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"RobinChen121/robinchen121.github.io","data-repo-id":"R_kgDOLSWA9g","data-category":"Announcements","data-category-id":"DIC_kwDOLSWA9s4CgWHu","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Zhen Chen. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>