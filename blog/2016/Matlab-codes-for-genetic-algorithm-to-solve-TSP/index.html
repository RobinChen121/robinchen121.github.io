<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Genetic algorithm in matlab to solve travelling salesman problem | Zhen Chen </title> <meta name="author" content="Zhen Chen"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="python, stochastic inventory, optimization, statistics"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://robinchen121.github.io/blog/2016/Matlab-codes-for-genetic-algorithm-to-solve-TSP/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Zhen</span> Chen </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Research </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/teach/">Teach </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/journey/">Academic journey</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Genetic algorithm in matlab to solve travelling salesman problem</h1> <p class="post-meta"> November 02, 2016 </p> <p class="post-tags"> <a href="/blog/2016"> <i class="fa-solid fa-calendar fa-sm"></i> 2016 </a>   ·   <a href="/blog/tag/genetic-algorithm"> <i class="fa-solid fa-hashtag fa-sm"></i> genetic algorithm</a>   <a href="/blog/tag/matlab"> <i class="fa-solid fa-hashtag fa-sm"></i> matlab</a>   <a href="/blog/tag/tsp"> <i class="fa-solid fa-hashtag fa-sm"></i> TSP</a>     ·   <a href="/blog/category/optimization"> <i class="fa-solid fa-tag fa-sm"></i> optimization</a>   <a href="/blog/category/matlab"> <i class="fa-solid fa-tag fa-sm"></i> matlab</a>   </p> </header> <article class="post-content"> <div id="markdown-content" style="text-align: justify"> <p>When learning heuristic algorithms, the Traveling Salesman Problem (TSP) serves as a classic example. Among them, genetic algorithms can be employed to solve this problem. Genetic algorithms, being an evolutionary algorithm, do not guarantee obtaining the optimal solution due to their heuristic nature. The effectiveness of the solution is influenced by factors such as the selection of the initial population, encoding method, selection method, and crossover-mutation rules.</p> <p>During learning, the teacher somehow found a very rudimentary program. I corrected numerous errors, added some comments for better understanding, and incorporated additional code to enhance the program’s perfection. This code dynamically displays the route for each generation, providing a very intuitive visualization! (Note: For a general TSP problem, it has been observed that by formulating it as an integer programming problem and using the callback method in mathematical programming solver software like Gurobi, even for large-scale problems (75 cities), the optimal solution can be obtained within 1 second. In such cases, using heuristic algorithms may not be necessary. Refer to the website: <a href="https://www.gurobi.com/resource/traveling-salesman-problem/" rel="external nofollow noopener" target="_blank">https://www.gurobi.com/resource/traveling-salesman-problem/)</a></p> <div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">GaTSPChen</span>

<span class="c1">% mainly amended by Chen Zhen, 2012~2016</span>

<span class="n">CityNum</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="c1">% 城市数目，可以选 10, 30, 50, 75</span>
<span class="p">[</span><span class="n">dislist</span><span class="p">,</span> <span class="n">Clist</span><span class="p">]</span> <span class="o">=</span> <span class="n">tsp</span><span class="p">(</span><span class="n">CityNum</span><span class="p">);</span> <span class="c1">% dislist 为城市之间相互的距离，Clist 为各城市的坐标</span>

<span class="n">inn</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="c1">% 初始种群大小</span>
<span class="n">gnMax</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>  <span class="c1">% 最大代数</span>
<span class="n">crossProb</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">;</span> <span class="c1">% 交叉概率</span>
<span class="n">muteProb</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">;</span> <span class="c1">% 变异概率</span>

<span class="c1">% 随机产生初始种群</span>
<span class="n">population</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">inn</span><span class="p">,</span> <span class="n">CityNum</span><span class="p">);</span> <span class="c1">% population 为初始种群，包括多条染色体</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">inn</span>
    <span class="n">population</span><span class="p">(</span><span class="n">i</span><span class="p">,:)</span> <span class="o">=</span> <span class="nb">randperm</span><span class="p">(</span><span class="n">CityNum</span><span class="p">);</span>
<span class="k">end</span>
<span class="p">[</span><span class="o">~</span><span class="p">,</span> <span class="n">cumulativeProbs</span><span class="p">]</span> <span class="o">=</span> <span class="n">calPopulationValue</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">dislist</span><span class="p">);</span> <span class="c1">% 计算种群每条染色体的累计概率</span>

<span class="n">generationNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">generationMeanValue</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">generationNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">% 每一代的平均距离</span>
<span class="n">generationMaxValue</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">generationNum</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  <span class="c1">% 每一代的最短距离</span>
<span class="n">bestRoute</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">inn</span><span class="p">,</span> <span class="n">CityNum</span><span class="p">);</span> <span class="c1">% 最佳路径</span>
<span class="n">newPopulation</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">inn</span><span class="p">,</span> <span class="n">CityNum</span><span class="p">);</span> <span class="c1">% 新的种群</span>
<span class="k">while</span> <span class="n">generationNum</span> <span class="o">&lt;</span> <span class="n">gnMax</span> <span class="o">+</span> <span class="mi">1</span>
   <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">2</span> <span class="p">:</span> <span class="n">inn</span>
      <span class="n">selectedChromos</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">cumulativeProbs</span><span class="p">);</span>  <span class="c1">% 选择操作，选出两条需要交叉编译的染色体，即父亲母亲</span>
      <span class="n">crossedChromos</span> <span class="o">=</span> <span class="nb">cross</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">selectedChromos</span><span class="p">,</span> <span class="n">crossProb</span><span class="p">);</span>  <span class="c1">% 交叉操作，返回交叉后的染色体</span>
      <span class="n">newPopulation</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">mut</span><span class="p">(</span><span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">:),</span><span class="n">muteProb</span><span class="p">);</span>  <span class="c1">% 对交叉后的染色体进行变异操作</span>
      <span class="n">newPopulation</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">mut</span><span class="p">(</span><span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">:),</span> <span class="n">muteProb</span><span class="p">);</span> <span class="c1">% 对交叉后的染色体进行变异操作</span>
   <span class="k">end</span>
   <span class="n">population</span> <span class="o">=</span> <span class="n">newPopulation</span><span class="p">;</span>  <span class="c1">%产生了新的种群</span>
   <span class="p">[</span><span class="n">populationValue</span><span class="p">,</span> <span class="n">cumulativeProbs</span><span class="p">]</span> <span class="o">=</span> <span class="n">calPopulationValue</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">dislist</span><span class="p">);</span>  <span class="c1">% 计算新种群的适应度</span>
   <span class="c1">% 记录当前代最好和平均的适应度</span>
   <span class="p">[</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nmax</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">populationValue</span><span class="p">);</span> <span class="c1">% 因为计算适应度时取距离的倒数，这里面取最大的倒数，即最短的距离</span>
   <span class="n">generationMeanValue</span><span class="p">(</span><span class="n">generationNum</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">/</span> <span class="nb">mean</span><span class="p">(</span><span class="n">populationValue</span><span class="p">);</span>
   <span class="n">generationMaxValue</span><span class="p">(</span><span class="n">generationNum</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">/</span> <span class="n">fmax</span><span class="p">;</span>
   <span class="n">bestChromo</span> <span class="o">=</span> <span class="n">population</span><span class="p">(</span><span class="n">nmax</span><span class="p">,</span> <span class="p">:);</span>  <span class="c1">% 前代最佳染色体，即对应的路径</span>
   <span class="n">bestRoute</span><span class="p">(</span><span class="n">generationNum</span><span class="p">,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">bestChromo</span><span class="p">;</span> <span class="c1">% 记录每一代的最佳染色体</span>
   <span class="n">drawTSP</span><span class="p">(</span><span class="n">Clist</span><span class="p">,</span> <span class="n">bestChromo</span><span class="p">,</span> <span class="n">generationMaxValue</span><span class="p">(</span><span class="n">generationNum</span><span class="p">),</span> <span class="n">generationNum</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
   <span class="n">generationNum</span> <span class="o">=</span> <span class="n">generationNum</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">end</span>
<span class="p">[</span><span class="n">bestValue</span><span class="p">,</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">generationMaxValue</span><span class="p">);</span>
<span class="n">drawTSP</span><span class="p">(</span><span class="n">Clist</span><span class="p">,</span> <span class="n">bestRoute</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="p">:),</span> <span class="n">bestValue</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

<span class="nb">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">generationMaxValue</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">);</span>
<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">generationMeanValue</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">);</span>
<span class="nb">grid</span><span class="p">;</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'搜索过程'</span><span class="p">);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s1">'最优解'</span><span class="p">,</span> <span class="s1">'平均解'</span><span class="p">);</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s1">'遗传算法得到的最短距离: %.2f\n'</span><span class="p">,</span> <span class="n">bestValue</span><span class="p">);</span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s1">'遗传算法得到的最短路线'</span><span class="p">);</span>
<span class="nb">disp</span><span class="p">(</span><span class="n">bestRoute</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="p">:));</span>
<span class="k">end</span>

<span class="c1">%------------------------------------------------</span>
<span class="c1">% 计算所有染色体的适应度</span>
<span class="k">function</span> <span class="p">[</span><span class="n">chromoValues</span><span class="p">,</span> <span class="n">cumulativeProbs</span><span class="p">]</span> <span class="o">=</span> <span class="n">calPopulationValue</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">dislist</span><span class="p">)</span>
<span class="n">inn</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  <span class="c1">% 读取种群大小</span>
<span class="n">chromoValues</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">inn</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">inn</span>
    <span class="n">chromoValues</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">CalDist</span><span class="p">(</span><span class="n">dislist</span><span class="p">,</span> <span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">:));</span>  <span class="c1">% 计算每条染色体的适应度</span>
<span class="k">end</span>
<span class="n">chromoValues</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">/</span><span class="n">chromoValues</span><span class="o">'</span><span class="p">;</span> <span class="c1">% 因为让距离越小，选取的概率越高，所以取距离倒数</span>
<span class="c1">% 根据个体的适应度计算其被选择的概率</span>
<span class="n">fsum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">inn</span>
    <span class="c1">% 乘以15次方的原因是让好的个体被选取的概率更大（因为适应度取距离的倒数，若不乘次方，则个体相互之间的适应度差别不大），换成一个较大的数也行</span>
    <span class="n">fsum</span> <span class="o">=</span> <span class="n">fsum</span> <span class="o">+</span> <span class="n">chromoValues</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">^</span><span class="mi">15</span><span class="p">;</span>
<span class="k">end</span>
<span class="c1">% 计算单个概率</span>
<span class="n">probs</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">inn</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span> <span class="n">inn</span>
    <span class="n">probs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">chromoValues</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">^</span><span class="mi">15</span> <span class="p">/</span> <span class="n">fsum</span><span class="p">;</span>
<span class="k">end</span>
<span class="c1">% 计算累积概率</span>
<span class="n">cumulativeProbs</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">inn</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">cumulativeProbs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">probs</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">:</span> <span class="n">inn</span>
    <span class="n">cumulativeProbs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">cumulativeProbs</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">probs</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="k">end</span>
<span class="n">cumulativeProbs</span> <span class="o">=</span> <span class="n">cumulativeProbs</span><span class="o">'</span><span class="p">;</span>
<span class="k">end</span>

<span class="c1">%--------------------------------------------------</span>
<span class="c1">%“选择”操作，返回所选择染色体在种群中对应的位置</span>
<span class="c1">% cumulatedPro 所有染色体的累计概率</span>
<span class="k">function</span> <span class="n">selectedChromoNums</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">cumulatedPro</span><span class="p">)</span>
<span class="n">selectedChromoNums</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="c1">% 从种群中选择两个个体，最好不要两次选择同一个个体</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">2</span>
   <span class="n">r</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">;</span>  <span class="c1">% 产生一个随机数</span>
   <span class="n">prand</span> <span class="o">=</span> <span class="n">cumulatedPro</span> <span class="o">-</span> <span class="n">r</span><span class="p">;</span>
   <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="k">while</span> <span class="n">prand</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
       <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
   <span class="k">end</span>
   <span class="n">selectedChromoNums</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span> <span class="c1">% 选中个体的序号</span>
   <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">j</span> <span class="o">==</span> <span class="n">selectedChromoNums</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>    <span class="c1">% 若相同就再选一次</span>
       <span class="n">r</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">;</span>  <span class="c1">% 产生一个随机数</span>
       <span class="n">prand</span> <span class="o">=</span> <span class="n">cumulatedPro</span> <span class="o">-</span> <span class="n">r</span><span class="p">;</span>
       <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
       <span class="k">while</span> <span class="n">prand</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
           <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
       <span class="k">end</span>
   <span class="k">end</span>
<span class="k">end</span>
<span class="k">end</span>

<span class="c1">%------------------------------------------------</span>
<span class="c1">% “交叉”操作</span>
<span class="k">function</span> <span class="n">crossedChromos</span> <span class="o">=</span> <span class="nb">cross</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">selectedChromoNums</span><span class="p">,</span> <span class="n">crossProb</span><span class="p">)</span>
<span class="nb">length</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">% 染色体的长度</span>
<span class="n">crossProbc</span> <span class="o">=</span> <span class="n">crossMuteOrNot</span><span class="p">(</span><span class="n">crossProb</span><span class="p">);</span>  <span class="c1">%根据交叉概率决定是否进行交叉操作，1则是，0则否</span>
<span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)</span> <span class="o">=</span> <span class="n">population</span><span class="p">(</span><span class="n">selectedChromoNums</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">:);</span>
<span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,:)</span> <span class="o">=</span> <span class="n">population</span><span class="p">(</span><span class="n">selectedChromoNums</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">:);</span>
<span class="k">if</span> <span class="n">crossProbc</span> <span class="o">==</span> <span class="mi">1</span>
   <span class="n">c1</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">rand</span> <span class="o">*</span> <span class="p">(</span><span class="nb">length</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">%在[1,bn - 1]范围内随机产生一个交叉位 c1</span>
   <span class="n">c2</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">rand</span> <span class="o">*</span> <span class="p">(</span><span class="nb">length</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">%在[1,bn - 1]范围内随机产生一个交叉位 c2</span>
   <span class="n">chb1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">);</span>
   <span class="n">chb2</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">);</span>
   <span class="n">middle</span> <span class="o">=</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">chb1</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">chb2</span><span class="p">);</span> <span class="c1">% 两条染色体 chb1 到 chb2 之间互换位置</span>
   <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">chb1</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb2</span><span class="p">)</span><span class="o">=</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">chb1</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb2</span><span class="p">);</span>
   <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">chb1</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb2</span><span class="p">)</span><span class="o">=</span> <span class="n">middle</span><span class="p">;</span>
   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb1</span> <span class="c1">% 看交叉后，染色体上是否有相同编码的情况（路径上重复出现两个城市）。若有，则该编码不参与交叉</span>
       <span class="k">while</span> <span class="nb">find</span><span class="p">(</span><span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">chb1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">chb2</span><span class="p">)</span> <span class="o">==</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
           <span class="n">location</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">chb1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">chb2</span><span class="p">)</span> <span class="o">==</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
           <span class="n">y</span> <span class="o">=</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">chb1</span> <span class="o">+</span> <span class="n">location</span><span class="p">);</span>
           <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
       <span class="k">end</span>
       <span class="k">while</span> <span class="nb">find</span><span class="p">(</span><span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">chb1</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb2</span><span class="p">)</span> <span class="o">==</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
           <span class="n">location</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">chb1</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb2</span><span class="p">)</span> <span class="o">==</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
           <span class="n">y</span> <span class="o">=</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">chb1</span> <span class="o">+</span> <span class="n">location</span><span class="p">);</span>
           <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
       <span class="k">end</span>
   <span class="k">end</span>
   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="n">chb2</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="nb">length</span>
       <span class="k">while</span> <span class="nb">find</span><span class="p">(</span><span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb2</span><span class="p">)</span> <span class="o">==</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
           <span class="n">location</span> <span class="o">=</span> <span class="nb">logical</span><span class="p">(</span><span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb2</span><span class="p">)</span> <span class="o">==</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
           <span class="n">y</span> <span class="o">=</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">location</span><span class="p">);</span>
           <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
       <span class="k">end</span>
       <span class="k">while</span> <span class="nb">find</span><span class="p">(</span><span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb2</span><span class="p">)</span> <span class="o">==</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
           <span class="n">location</span> <span class="o">=</span> <span class="nb">logical</span><span class="p">(</span><span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb2</span><span class="p">)</span> <span class="o">==</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
           <span class="n">y</span> <span class="o">=</span> <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">location</span><span class="p">);</span>
           <span class="n">crossedChromos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
       <span class="k">end</span>
   <span class="k">end</span>
<span class="k">end</span>
<span class="k">end</span>

<span class="c1">%--------------------------------------------------</span>
<span class="c1">%“变异”操作</span>
<span class="c1">% choromo 为一条染色体</span>
<span class="k">function</span> <span class="n">snnew</span> <span class="o">=</span> <span class="n">mut</span><span class="p">(</span><span class="n">chromo</span><span class="p">,</span><span class="n">muteProb</span><span class="p">)</span>
<span class="nb">length</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">chromo</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">% 染色体的的长度</span>
<span class="n">snnew</span> <span class="o">=</span> <span class="n">chromo</span><span class="p">;</span>
<span class="n">muteProbm</span> <span class="o">=</span> <span class="n">crossMuteOrNot</span><span class="p">(</span><span class="n">muteProb</span><span class="p">);</span>  <span class="c1">% 根据变异概率决定是否进行变异操作，1则是，0则否</span>
<span class="k">if</span> <span class="n">muteProbm</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">rand</span><span class="o">*</span><span class="p">(</span><span class="nb">length</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">% 在 [1, bn - 1]范围内随机产生一个变异位</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">rand</span><span class="o">*</span><span class="p">(</span><span class="nb">length</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">% 在 [1, bn - 1]范围内随机产生一个变异位</span>
    <span class="n">chb1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">);</span>
    <span class="n">chb2</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">);</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">chromo</span><span class="p">(</span><span class="n">chb1</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb2</span><span class="p">);</span>
    <span class="n">snnew</span><span class="p">(</span><span class="n">chb1</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">chb2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">fliplr</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="c1">% 变异，则将两个变异位置的染色体倒转</span>
<span class="k">end</span>
<span class="k">end</span>

<span class="c1">% 根据变异或交叉概率，返回一个 0 或 1 的数</span>
<span class="k">function</span> <span class="n">crossProbc</span> <span class="o">=</span> <span class="n">crossMuteOrNot</span><span class="p">(</span><span class="n">crossMuteProb</span><span class="p">)</span>
<span class="n">test</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span> <span class="mi">100</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">l</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">crossMuteProb</span><span class="p">);</span>
<span class="n">test</span><span class="p">(</span><span class="mi">1</span> <span class="p">:</span> <span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">rand</span> <span class="o">*</span> <span class="mi">99</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">crossProbc</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="k">end</span>

<span class="c1">%------------------------------------------------</span>
<span class="c1">% 计算一条染色体的适应度</span>
<span class="c1">% dislist 为所有城市相互之间的距离矩阵</span>
<span class="c1">% chromo 为一条染色体，即一条路径</span>
<span class="k">function</span> <span class="n">chromoValue</span> <span class="o">=</span> <span class="n">CalDist</span><span class="p">(</span><span class="n">dislist</span><span class="p">,</span> <span class="n">chromo</span><span class="p">)</span>
<span class="n">DistanV</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">chromo</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">% 染色体的长度</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">DistanV</span> <span class="o">=</span> <span class="n">DistanV</span> <span class="o">+</span> <span class="n">dislist</span><span class="p">(</span><span class="n">chromo</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">chromo</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
<span class="k">end</span>
<span class="n">DistanV</span> <span class="o">=</span> <span class="n">DistanV</span> <span class="o">+</span> <span class="n">dislist</span><span class="p">(</span><span class="n">chromo</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">chromo</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="n">chromoValue</span> <span class="o">=</span> <span class="n">DistanV</span><span class="p">;</span>
<span class="k">end</span>

<span class="c1">%------------------------------------------------</span>
<span class="c1">% 画图</span>
<span class="c1">% Clist 为城市坐标</span>
<span class="c1">% route 为一条路径</span>
<span class="k">function</span> <span class="n">drawTSP</span><span class="p">(</span><span class="n">Clist</span><span class="p">,</span> <span class="n">route</span><span class="p">,</span> <span class="n">generationValue</span><span class="p">,</span> <span class="n">generationNum</span><span class="p">,</span><span class="n">isBestGeneration</span><span class="p">)</span>
<span class="n">CityNum</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">Clist</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">CityNum</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="nb">plot</span><span class="p">([</span><span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span><span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="mi">2</span><span class="p">),</span><span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)],</span><span class="s1">'ms-'</span><span class="p">,</span><span class="s1">'LineWidth'</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">'MarkerEdgeColor'</span><span class="p">,</span><span class="s1">'k'</span><span class="p">,</span><span class="s1">'MarkerFaceColor'</span><span class="p">,</span><span class="s1">'g'</span><span class="p">);</span>
    <span class="nb">text</span><span class="p">(</span><span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span><span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="s1">'  '</span><span class="p">,</span> <span class="nb">int2str</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">i</span><span class="p">))]);</span>
    <span class="nb">text</span><span class="p">(</span><span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span><span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="s1">'  '</span><span class="p">,</span> <span class="nb">int2str</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))]);</span>
    <span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="k">end</span>
<span class="nb">plot</span><span class="p">([</span><span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">CityNum</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">[</span><span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="n">CityNum</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Clist</span><span class="p">(</span><span class="n">route</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">)],</span><span class="s1">'ms-'</span><span class="p">,</span><span class="s1">'LineWidth'</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">'MarkerEdgeColor'</span><span class="p">,</span><span class="s1">'k'</span><span class="p">,</span><span class="s1">'MarkerFaceColor'</span><span class="p">,</span><span class="s1">'g'</span><span class="p">);</span>
<span class="nb">title</span><span class="p">([</span><span class="nb">num2str</span><span class="p">(</span><span class="n">CityNum</span><span class="p">),</span><span class="s1">'城市TSP'</span><span class="p">]);</span>
<span class="k">if</span> <span class="n">isBestGeneration</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">CityNum</span> <span class="o">~=</span> <span class="mi">10</span>
    <span class="nb">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s1">'第 '</span><span class="p">,</span><span class="nb">int2str</span><span class="p">(</span><span class="n">generationNum</span><span class="p">),</span><span class="s1">' 代'</span><span class="p">,</span><span class="s1">'  最短距离为 '</span><span class="p">,</span> <span class="nb">num2str</span><span class="p">(</span><span class="n">generationValue</span><span class="p">)]);</span>
<span class="k">else</span>
    <span class="nb">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s1">'最终搜索结果：最短距离 '</span><span class="p">,</span><span class="nb">num2str</span><span class="p">(</span><span class="n">generationValue</span><span class="p">),</span><span class="s1">'， 在第 '</span><span class="p">,</span><span class="nb">num2str</span><span class="p">(</span><span class="n">generationNum</span><span class="p">),</span><span class="s1">' 代达到'</span><span class="p">]);</span>
<span class="k">end</span>
<span class="k">if</span> <span class="n">CityNum</span> <span class="o">==</span> <span class="mi">10</span>  <span class="c1">% 因为文字显示位置不一样，所以将城市数目为 10 时单独编写</span>
    <span class="k">if</span> <span class="n">isBestGeneration</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="nb">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="s1">'第 '</span><span class="p">,</span><span class="nb">int2str</span><span class="p">(</span><span class="n">generationNum</span><span class="p">),</span><span class="s1">' 代'</span><span class="p">,</span><span class="s1">'  最短距离为 '</span><span class="p">,</span> <span class="nb">num2str</span><span class="p">(</span><span class="n">generationValue</span><span class="p">)]);</span>
    <span class="k">else</span>
        <span class="nb">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="s1">'最终搜索结果：最短距离 '</span><span class="p">,</span><span class="nb">num2str</span><span class="p">(</span><span class="n">generationValue</span><span class="p">),</span><span class="s1">'， 在第 '</span><span class="p">,</span> <span class="nb">num2str</span><span class="p">(</span><span class="n">generationNum</span><span class="p">),</span><span class="s1">' 代达到'</span><span class="p">]);</span>
    <span class="k">end</span>
<span class="k">end</span>
<span class="nb">hold</span> <span class="n">off</span><span class="p">;</span>
<span class="nb">pause</span><span class="p">(</span><span class="mf">0.005</span><span class="p">);</span>
<span class="k">end</span>

<span class="c1">%------------------------------------------------</span>
<span class="c1">%城市位置坐标</span>
<span class="k">function</span> <span class="p">[</span><span class="n">DLn</span><span class="p">,</span> <span class="n">cityn</span><span class="p">]</span> <span class="o">=</span> <span class="n">tsp</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">DLn</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
<span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">10</span>
    <span class="n">city10</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span> <span class="mf">0.4439</span><span class="p">;</span><span class="mf">0.2439</span> <span class="mf">0.1463</span><span class="p">;</span><span class="mf">0.1707</span> <span class="mf">0.2293</span><span class="p">;</span><span class="mf">0.2293</span> <span class="mf">0.761</span><span class="p">;</span><span class="mf">0.5171</span> <span class="mf">0.9414</span><span class="p">;</span>
        <span class="mf">0.8732</span> <span class="mf">0.6536</span><span class="p">;</span><span class="mf">0.6878</span> <span class="mf">0.5219</span><span class="p">;</span><span class="mf">0.8488</span> <span class="mf">0.3609</span><span class="p">;</span><span class="mf">0.6683</span> <span class="mf">0.2536</span><span class="p">;</span><span class="mf">0.6195</span> <span class="mf">0.2634</span><span class="p">];</span><span class="c1">%10 cities d'=2.691</span>
    <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">10</span>
        <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">10</span>
            <span class="n">DLn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="p">((</span><span class="n">city10</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">city10</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">city10</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">city10</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mf">0.5</span><span class="p">;</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">cityn</span> <span class="o">=</span> <span class="n">city10</span><span class="p">;</span>
<span class="k">end</span>
<span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">30</span>
    <span class="n">city30</span> <span class="o">=</span> <span class="p">[</span><span class="mi">41</span> <span class="mi">94</span><span class="p">;</span><span class="mi">37</span> <span class="mi">84</span><span class="p">;</span><span class="mi">54</span> <span class="mi">67</span><span class="p">;</span><span class="mi">25</span> <span class="mi">62</span><span class="p">;</span><span class="mi">7</span> <span class="mi">64</span><span class="p">;</span><span class="mi">2</span> <span class="mi">99</span><span class="p">;</span><span class="mi">68</span> <span class="mi">58</span><span class="p">;</span><span class="mi">71</span> <span class="mi">44</span><span class="p">;</span><span class="mi">54</span> <span class="mi">62</span><span class="p">;</span><span class="mi">83</span> <span class="mi">69</span><span class="p">;</span><span class="mi">64</span> <span class="mi">60</span><span class="p">;</span><span class="mi">18</span> <span class="mi">54</span><span class="p">;</span><span class="mi">22</span> <span class="mi">60</span><span class="p">;</span>
        <span class="mi">83</span> <span class="mi">46</span><span class="p">;</span><span class="mi">91</span> <span class="mi">38</span><span class="p">;</span><span class="mi">25</span> <span class="mi">38</span><span class="p">;</span><span class="mi">24</span> <span class="mi">42</span><span class="p">;</span><span class="mi">58</span> <span class="mi">69</span><span class="p">;</span><span class="mi">71</span> <span class="mi">71</span><span class="p">;</span><span class="mi">74</span> <span class="mi">78</span><span class="p">;</span><span class="mi">87</span> <span class="mi">76</span><span class="p">;</span><span class="mi">18</span> <span class="mi">40</span><span class="p">;</span><span class="mi">13</span> <span class="mi">40</span><span class="p">;</span><span class="mi">82</span> <span class="mi">7</span><span class="p">;</span><span class="mi">62</span> <span class="mi">32</span><span class="p">;</span><span class="mi">58</span> <span class="mi">35</span><span class="p">;</span><span class="mi">45</span> <span class="mi">21</span><span class="p">;</span><span class="mi">41</span> <span class="mi">26</span><span class="p">;</span><span class="mi">44</span> <span class="mi">35</span><span class="p">;</span><span class="mi">4</span> <span class="mi">50</span><span class="p">];</span> <span class="c1">% 30 cities d' = 423.741 by D B Fogel</span>
    <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">30</span>
        <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">30</span>
            <span class="n">DLn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="p">((</span><span class="n">city30</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">city30</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">city30</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">city30</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mf">0.5</span><span class="p">;</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">cityn</span> <span class="o">=</span> <span class="n">city30</span><span class="p">;</span>
<span class="k">end</span>

<span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">50</span>
    <span class="n">city50</span> <span class="o">=</span> <span class="p">[</span><span class="mi">31</span> <span class="mi">32</span><span class="p">;</span><span class="mi">32</span> <span class="mi">39</span><span class="p">;</span><span class="mi">40</span> <span class="mi">30</span><span class="p">;</span><span class="mi">37</span> <span class="mi">69</span><span class="p">;</span><span class="mi">27</span> <span class="mi">68</span><span class="p">;</span><span class="mi">37</span> <span class="mi">52</span><span class="p">;</span><span class="mi">38</span> <span class="mi">46</span><span class="p">;</span><span class="mi">31</span> <span class="mi">62</span><span class="p">;</span><span class="mi">30</span> <span class="mi">48</span><span class="p">;</span><span class="mi">21</span> <span class="mi">47</span><span class="p">;</span><span class="mi">25</span> <span class="mi">55</span><span class="p">;</span><span class="mi">16</span> <span class="mi">57</span><span class="p">;</span>
        <span class="mi">17</span> <span class="mi">63</span><span class="p">;</span><span class="mi">42</span> <span class="mi">41</span><span class="p">;</span><span class="mi">17</span> <span class="mi">33</span><span class="p">;</span><span class="mi">25</span> <span class="mi">32</span><span class="p">;</span><span class="mi">5</span> <span class="mi">64</span><span class="p">;</span><span class="mi">8</span> <span class="mi">52</span><span class="p">;</span><span class="mi">12</span> <span class="mi">42</span><span class="p">;</span><span class="mi">7</span> <span class="mi">38</span><span class="p">;</span><span class="mi">5</span> <span class="mi">25</span><span class="p">;</span> <span class="mi">10</span> <span class="mi">77</span><span class="p">;</span><span class="mi">45</span> <span class="mi">35</span><span class="p">;</span><span class="mi">42</span> <span class="mi">57</span><span class="p">;</span><span class="mi">32</span> <span class="mi">22</span><span class="p">;</span>
        <span class="mi">27</span> <span class="mi">23</span><span class="p">;</span><span class="mi">56</span> <span class="mi">37</span><span class="p">;</span><span class="mi">52</span> <span class="mi">41</span><span class="p">;</span><span class="mi">49</span> <span class="mi">49</span><span class="p">;</span><span class="mi">58</span> <span class="mi">48</span><span class="p">;</span><span class="mi">57</span> <span class="mi">58</span><span class="p">;</span><span class="mi">39</span> <span class="mi">10</span><span class="p">;</span><span class="mi">46</span> <span class="mi">10</span><span class="p">;</span><span class="mi">59</span> <span class="mi">15</span><span class="p">;</span><span class="mi">51</span> <span class="mi">21</span><span class="p">;</span><span class="mi">48</span> <span class="mi">28</span><span class="p">;</span><span class="mi">52</span> <span class="mi">33</span><span class="p">;</span>
        <span class="mi">58</span> <span class="mi">27</span><span class="p">;</span><span class="mi">61</span> <span class="mi">33</span><span class="p">;</span><span class="mi">62</span> <span class="mi">63</span><span class="p">;</span><span class="mi">20</span> <span class="mi">26</span><span class="p">;</span><span class="mi">5</span> <span class="mi">6</span><span class="p">;</span><span class="mi">13</span> <span class="mi">13</span><span class="p">;</span><span class="mi">21</span> <span class="mi">10</span><span class="p">;</span><span class="mi">30</span> <span class="mi">15</span><span class="p">;</span><span class="mi">36</span> <span class="mi">16</span><span class="p">;</span><span class="mi">62</span> <span class="mi">42</span><span class="p">;</span><span class="mi">63</span> <span class="mi">69</span><span class="p">;</span><span class="mi">52</span> <span class="mi">64</span><span class="p">;</span><span class="mi">43</span> <span class="mi">67</span><span class="p">];</span><span class="c1">%50 cities d'=427.855 by D B Fogel</span>
    <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">50</span>
        <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="mi">50</span>
            <span class="n">DLn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="p">((</span><span class="n">city50</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">city50</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">city50</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">city50</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mf">0.5</span><span class="p">;</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">cityn</span> <span class="o">=</span> <span class="n">city50</span><span class="p">;</span>
<span class="k">end</span>
<span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">75</span>
    <span class="n">city75</span> <span class="o">=</span> <span class="p">[</span><span class="mi">48</span> <span class="mi">21</span><span class="p">;</span><span class="mi">52</span> <span class="mi">26</span><span class="p">;</span><span class="mi">55</span> <span class="mi">50</span><span class="p">;</span><span class="mi">50</span> <span class="mi">50</span><span class="p">;</span><span class="mi">41</span> <span class="mi">46</span><span class="p">;</span><span class="mi">51</span> <span class="mi">42</span><span class="p">;</span><span class="mi">55</span> <span class="mi">45</span><span class="p">;</span><span class="mi">38</span> <span class="mi">33</span><span class="p">;</span><span class="mi">33</span> <span class="mi">34</span><span class="p">;</span><span class="mi">45</span> <span class="mi">35</span><span class="p">;</span><span class="mi">40</span> <span class="mi">37</span><span class="p">;</span><span class="mi">50</span> <span class="mi">30</span><span class="p">;</span>
        <span class="mi">55</span> <span class="mi">34</span><span class="p">;</span><span class="mi">54</span> <span class="mi">38</span><span class="p">;</span><span class="mi">26</span> <span class="mi">13</span><span class="p">;</span><span class="mi">15</span> <span class="mi">5</span><span class="p">;</span><span class="mi">21</span> <span class="mi">48</span><span class="p">;</span><span class="mi">29</span> <span class="mi">39</span><span class="p">;</span><span class="mi">33</span> <span class="mi">44</span><span class="p">;</span><span class="mi">15</span> <span class="mi">19</span><span class="p">;</span><span class="mi">16</span> <span class="mi">19</span><span class="p">;</span><span class="mi">12</span> <span class="mi">17</span><span class="p">;</span><span class="mi">50</span> <span class="mi">40</span><span class="p">;</span><span class="mi">22</span> <span class="mi">53</span><span class="p">;</span><span class="mi">21</span> <span class="mi">36</span><span class="p">;</span>
        <span class="mi">20</span> <span class="mi">30</span><span class="p">;</span><span class="mi">26</span> <span class="mi">29</span><span class="p">;</span><span class="mi">40</span> <span class="mi">20</span><span class="p">;</span><span class="mi">36</span> <span class="mi">26</span><span class="p">;</span><span class="mi">62</span> <span class="mi">48</span><span class="p">;</span><span class="mi">67</span> <span class="mi">41</span><span class="p">;</span><span class="mi">62</span> <span class="mi">35</span><span class="p">;</span><span class="mi">65</span> <span class="mi">27</span><span class="p">;</span><span class="mi">62</span> <span class="mi">24</span><span class="p">;</span><span class="mi">55</span> <span class="mi">20</span><span class="p">;</span><span class="mi">35</span> <span class="mi">51</span><span class="p">;</span><span class="mi">30</span> <span class="mi">50</span><span class="p">;</span>
        <span class="mi">45</span> <span class="mi">42</span><span class="p">;</span><span class="mi">21</span> <span class="mi">45</span><span class="p">;</span><span class="mi">36</span> <span class="mi">6</span><span class="p">;</span><span class="mi">6</span> <span class="mi">25</span><span class="p">;</span><span class="mi">11</span> <span class="mi">28</span><span class="p">;</span><span class="mi">26</span> <span class="mi">59</span><span class="p">;</span><span class="mi">30</span> <span class="mi">60</span><span class="p">;</span><span class="mi">22</span> <span class="mi">22</span><span class="p">;</span><span class="mi">27</span> <span class="mi">24</span><span class="p">;</span><span class="mi">30</span> <span class="mi">20</span><span class="p">;</span><span class="mi">35</span> <span class="mi">16</span><span class="p">;</span><span class="mi">54</span> <span class="mi">10</span><span class="p">;</span><span class="mi">50</span> <span class="mi">15</span><span class="p">;</span>
        <span class="mi">44</span> <span class="mi">13</span><span class="p">;</span><span class="mi">35</span> <span class="mi">60</span><span class="p">;</span><span class="mi">40</span> <span class="mi">60</span><span class="p">;</span><span class="mi">40</span> <span class="mi">66</span><span class="p">;</span><span class="mi">31</span> <span class="mi">76</span><span class="p">;</span><span class="mi">47</span> <span class="mi">66</span><span class="p">;</span><span class="mi">50</span> <span class="mi">70</span><span class="p">;</span><span class="mi">57</span> <span class="mi">72</span><span class="p">;</span><span class="mi">55</span> <span class="mi">65</span><span class="p">;</span><span class="mi">2</span> <span class="mi">38</span><span class="p">;</span><span class="mi">7</span> <span class="mi">43</span><span class="p">;</span><span class="mi">9</span> <span class="mi">56</span><span class="p">;</span><span class="mi">15</span> <span class="mi">56</span><span class="p">;</span>
        <span class="mi">10</span> <span class="mi">70</span><span class="p">;</span><span class="mi">17</span> <span class="mi">64</span><span class="p">;</span><span class="mi">55</span> <span class="mi">57</span><span class="p">;</span><span class="mi">62</span> <span class="mi">57</span><span class="p">;</span><span class="mi">70</span> <span class="mi">64</span><span class="p">;</span><span class="mi">64</span> <span class="mi">4</span><span class="p">;</span><span class="mi">59</span> <span class="mi">5</span><span class="p">;</span><span class="mi">50</span> <span class="mi">4</span><span class="p">;</span><span class="mi">60</span> <span class="mi">15</span><span class="p">;</span><span class="mi">66</span> <span class="mi">14</span><span class="p">;</span><span class="mi">66</span> <span class="mi">8</span><span class="p">;</span><span class="mi">43</span> <span class="mi">26</span><span class="p">];</span> <span class="c1">% 75 cities d'=549.18 by D B Fogel</span>
    <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">75</span>
        <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">75</span>
            <span class="n">DLn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="p">((</span><span class="n">city75</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">city75</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">city75</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">city75</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mf">0.5</span><span class="p">;</span>
        <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">cityn</span> <span class="o">=</span> <span class="n">city75</span><span class="p">;</span>
<span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2014/Wagner-Whitin-c++-java-matlab/">C++, Java and Matlab codes for Wagner-Whitin algorithm</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2015/ordered-integer-partition/">Matlab codes for ordered integer partition</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2016/matlab-c++-codes-for-knapsack-problems/">Matlab and C++ codes for dynamic programming to solve the knapsack problem</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/pursuing-paper-cash-flow-based-dynamic-inventory-management/">Pursuing the paper " cash-flow based dynamic inventory management"</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/distill/">a distill-style blog post</a> </li> <div id="giscus_thread" style="max-width: 1000px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"RobinChen121/robinchen121.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Zhen Chen. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>